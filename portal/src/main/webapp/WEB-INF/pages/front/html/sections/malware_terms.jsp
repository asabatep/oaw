<%@ include file="/common/taglibs.jsp" %> 
<%@page import="es.inteco.common.Constants"%>
<%@page import="java.util.HashMap"%>
<html:xhtml/>

<html:javascript formName="MalwareTermForm"/>

	<logic:present parameter="<%= Constants.ID_HIT %>">
		<bean:parameter name="<%= Constants.ID_HIT %>" id="idHit" />
	</logic:present>
	
	<bean:define id="scriptId"><inteco:properties key="ofuscado.hit.id" file="malware.properties" /></bean:define>
 	<bean:define id="terminoId"><inteco:properties key="terminos.b.hit.id" file="malware.properties" /></bean:define>
 	<bean:define id="domId"><inteco:properties key="dom.hit.id" file="malware.properties" /></bean:define>
 	<bean:define id="JscriptId"><inteco:properties key="ofuscado.hit.id" file="malware.properties" /></bean:define>
	<bean:define id="AscriptId"><inteco:properties key="actionscript.hit.id" file="malware.properties" /></bean:define>

	<div id="migas">
		<p class="oculto"><bean:message key="ubicacion.usuario" /> </p>
		<p><html:link forward="indexAdmin"><bean:message key="migas.inicio" /></html:link>
	 		<logic:equal name="<%= Constants.SUBMENU %>" value="<%= Constants.SUBMENU_CONFIG_MALWARE_A %>">
			 	/ <html:link forward="configModuloAMenu"><bean:message key="migas.config.malware.a" /></html:link>
	 			/ <html:link forward="configModuloA"><bean:message key="migas.edit.malware.a"/> </html:link>
			 	/ <bean:message key="migas.config.edit.term.malware.a" />
			 </logic:equal>
			 <logic:equal name="<%= Constants.SUBMENU %>" value="<%= Constants.SUBMENU_CONFIG_MALWARE_B %>">
			 	/ <html:link forward="configModuloBMenu"><bean:message key="migas.config.malware.b" /></html:link>
	 			/ <html:link forward="configModuloB"><bean:message key="migas.edit.malware.b"/> </html:link>
			 	<logic:equal parameter="<%= Constants.ID_HIT %>" value="<%= terminoId %>">
			 		/ <bean:message key="migas.config.edit.term.malware.b.termino" />
			 	</logic:equal>
			 	<logic:equal parameter="<%= Constants.ID_HIT %>" value="<%= scriptId %>">
			 		/ <bean:message key="migas.config.edit.term.malware.b.script" />
			 	</logic:equal>
			 	<logic:equal parameter="<%= Constants.ID_HIT %>" value="<%= domId %>">
			 		/ <bean:message key="migas.config.edit.term.malware.b.dom" />
			 	</logic:equal>
			 </logic:equal>
			 <logic:equal name="<%= Constants.SUBMENU %>" value="<%= Constants.SUBMENU_CONFIG_MALWARE_C %>">
			 	/ <html:link forward="configModuloCMenu"><bean:message key="migas.config.malware.c" /></html:link>
	 			/ <html:link forward="configModuloC"><bean:message key="migas.edit.malware.c"/> </html:link>
			 	/ <bean:message key="migas.config.edit.term.malware.c" />
			 </logic:equal>
			 <logic:equal name="<%= Constants.SUBMENU %>" value="<%= Constants.SUBMENU_CONFIG_MALWARE_D %>">
			 	/ <html:link forward="configModuloDMenu"><bean:message key="migas.config.malware.d" /></html:link>
	 			/ <html:link forward="configModuloD"><bean:message key="migas.edit.malware.d"/> </html:link>
				<logic:equal parameter="<%= Constants.ID_HIT %>" value="<%= JscriptId %>">
			 		/ <bean:message key="migas.config.edit.term.malware.d.js" />
			 	</logic:equal>
			 	<logic:equal parameter="<%= Constants.ID_HIT %>" value="<%= AscriptId %>">
			 		/ <bean:message key="migas.config.edit.term.malware.d.as" />
			 	</logic:equal>
			</logic:equal>
	 	</p>
	</div>
	
	<div id="cuerpo">
		<div id="cIzq">&nbsp;</div>
		<div id="contenido">
			<div id="main">
				<h1 class="bulleth1"><bean:write name="<%=Constants.HEADER %>" ignore="true"/></h1>
	
				<div id="cuerpoprincipal">
					
					<div id="container_menu_izq">
						<jsp:include page="menu.jsp"/>
					</div>
					
					<div id="container_der">
					
						<h2 class="config"><bean:write name="<%=Constants.TITLE %>" ignore="true"/></h2>
					
						<p>
							<bean:write name="<%=Constants.INFO %>" ignore="true"/>
						</p>
						
						<html:form action="/secure/ConfigurarModulo" styleClass="formulario" onsubmit="return validateMalwareTermForm(this)">
							<html:hidden property="id"/>
							<html:hidden property="normalizedWeight" value="0"/>
							<input type="hidden" name="<%=Constants.ACTION %>" value="<%=Constants.SAVE_TERM %>"/>
							<input type="hidden" name="<%=Constants.ID_HIT %>" value="<bean:write name="<%=Constants.ID_HIT %>" />"/>
							<fieldset>
								<jsp:include page="/common/crawler_messages.jsp" />
								<div class="formItem">
									<label for="term"><strong class="labelVisu"><acronym title="<bean:message key="campo.obligatorio" />"> * </acronym><bean:message key="malware.term" />: </strong></label>
									<html:text styleId="term" property="term" styleClass="texto"/>
								</div>
								<div class="formItem">
									<label for="weight"><strong class="labelVisu"><acronym title="<bean:message key="campo.obligatorio" />"> * </acronym><bean:message key="malware.weight" />: </strong></label>
									<html:text styleId="weight" property="weight" styleClass="texto"/>
								</div>
								<div class="formItem">
									<label for="confidence"><strong class="labelVisu"><acronym title="<bean:message key="campo.obligatorio" />"> * </acronym><bean:message key="malware.confidence" />: </strong></label>
									<html:text styleId="confidence" property="confidence" styleClass="texto"/>
								</div>
								<div class="formButton">
									<html:submit><bean:message key="boton.aceptar" /></html:submit>
									<logic:present parameter="<%= Constants.IS_UPDATE %>">
										<html:cancel><bean:message key="boton.cancelar" /></html:cancel>
									</logic:present>
								</div>
							</fieldset>
						</html:form>
						
						<logic:notPresent parameter="<%= Constants.IS_UPDATE %>">
							<table>
								<caption><bean:write name="<%=Constants.CAPTION %>" ignore="true"/></caption>
								<tr>
									<th><bean:message key="malware.term"/></th>
									<th><bean:message key="malware.weight"/></th>
									<th><bean:message key="malware.confidence"/></th>
									<th><bean:message key="malware.actions"/></th>
								</tr>
								
								<bean:define id="idHitName"><%= Constants.ID_HIT %></bean:define>
								<jsp:useBean id="params" class="java.util.HashMap" />
								<c:set target="${params}" property="${idHitName}" value="${idHit}" />
								
								<logic:iterate name="<%=Constants.TERMS %>" id="term">
									<bean:define id="idTerm"><%= Constants.ID_TERMINO %></bean:define>
									<bean:define id="isUpdate"><%= Constants.IS_UPDATE %></bean:define>
									<c:set target="${params}" property="${idTerm}" value="${term.id}" />
									<tr>
										<td><bean:write name="term" property="term" ignore="true"/></td>
										<td><bean:write name="term" property="weight" ignore="true"/></td>
										<td><bean:write name="term" property="confidence" ignore="true"/></td>
										<td>
											<ul class="lista_linea">
												<li><html:link forward="deleteTerms" name="params"><img src="../images/bt_eliminar.gif" alt="<bean:message key="img.delete.term" />"/></html:link></li>
												<c:set target="${params}" property="${isUpdate}" value="1" />
												<li><html:link forward="editTerm" name="params"><img src="../images/bt_modificar.gif" alt="<bean:message key="img.edit.term" />"/></html:link></li>
											</ul>
										</td>
									</tr>
								</logic:iterate>
								
							</table>
						
							<div id="pCenter">
								<logic:equal name="<%=Constants.SUBMENU%>" value="<%=Constants.SUBMENU_CONFIG_MALWARE_A%>">
									<html:link forward="configModuloA" paramId="<%=Constants.ID_HIT %>" paramName="<%=Constants.ID_HIT %>"><img src="../images/bt_volver.gif" /></html:link>
								</logic:equal>
								<logic:equal name="<%=Constants.SUBMENU%>" value="<%=Constants.SUBMENU_CONFIG_MALWARE_B%>">
									<html:link forward="configModuloB" paramId="<%=Constants.ID_HIT %>" paramName="<%=Constants.ID_HIT %>"><img src="../images/bt_volver.gif" /></html:link>
								</logic:equal>
								<logic:equal name="<%=Constants.SUBMENU%>" value="<%=Constants.SUBMENU_CONFIG_MALWARE_C%>">
									<html:link forward="configModuloC" paramId="<%=Constants.ID_HIT %>" paramName="<%=Constants.ID_HIT %>"><img src="../images/bt_volver.gif" /></html:link>
								</logic:equal>
								<logic:equal name="<%=Constants.SUBMENU%>" value="<%=Constants.SUBMENU_CONFIG_MALWARE_D%>">
									<html:link forward="configModuloD" paramId="<%=Constants.ID_HIT %>" paramName="<%=Constants.ID_HIT %>"><img src="../images/bt_volver.gif" /></html:link>
								</logic:equal>
							</div>
						</logic:notPresent>
					</div>
				</div><!-- fin CUERPO PRINCIPAL -->
			</div>
		</div>	
	</div> 
