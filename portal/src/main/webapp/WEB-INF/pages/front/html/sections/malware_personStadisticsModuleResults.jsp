<%@ include file="/common/taglibs.jsp" %> 
<%@page import="es.inteco.common.Constants"%>
<%@page import="java.util.HashMap"%>
<html:xhtml/>
<html:javascript formName="ConfigBForm"/>
	
	<bean:parameter id="idRastreo" name="<%= Constants.ID_RASTREO %>"/>
	<bean:parameter id="isHT" name="<%= Constants.TYPE_PS_PARAM %>" />
	<bean:parameter id="id" name="<%= Constants.ID %>"/>
	
	<bean:define id="idRastreoName" value="<%= Constants.ID_RASTREO %>"/>
	<bean:define id="typePSName" value="<%= Constants.TYPE_PS_PARAM %>"/>
	<bean:define id="idName" value="<%= Constants.ID %>"/>
	<bean:define id="urlIdName" value="<%= Constants.URL_ID %>" />
	<bean:define id="actionParam" value="<%= Constants.ACTION %>" />
	<bean:define id="loadPSParam" value="<%= Constants.LOAD_PS %>" />
	
	<jsp:useBean id="paramsPS" class="java.util.HashMap" />
	<c:set target="${paramsPS}" property="${idRastreoName}" value="${idRastreo}" />
	<c:set target="${paramsPS}" property="${idName}" value="${id}" />
	
	<jsp:useBean id="paramsPSH" class="java.util.HashMap" />
	<c:set target="${paramsPSH}" property="${idRastreoName}" value="${idRastreo}" />
	<c:set target="${paramsPSH}" property="${idName}" value="${id}" />
	<c:set target="${paramsPSH}" property="${typePSName}" value="${isHT}" />
	<c:set target="${paramsPSH}" property="${actionParam}" value="${loadPSParam}" />
	
	<jsp:useBean id="paramsVolver" class="java.util.HashMap"/>
	<c:set target="${paramsVolver}" property="${idName}" value="${id}"/>
	<c:set target="${paramsVolver}" property="${typePSName}" value="${isHT}"/>
	<c:set target="${paramsVolver}" property="${idRastreoName}" value="${idRastreo}"/>
	
	<jsp:useBean id="paramsD" class="java.util.HashMap" />
	<c:set target="${paramsD}" property="${idName}" value="${id}"/>
	<c:set target="${paramsD}" property="${idRastreoName}" value="${idRastreo}"/>
	<c:set target="${paramsD}" property="${typePSName}" value="${isHT}"/>
	
	<div id="migas">
		<p class="oculto"><bean:message key="ubicacion.usuario" /> </p>
		<p><html:link forward="indexAdmin"><bean:message key="migas.inicio" /></html:link> / 
			<html:link forward="crawlingsMenu"><bean:message key="migas.rastreo" /></html:link> /
		 	<html:link forward="verRastreosRealizados" paramId="<%= Constants.ID_RASTREO %>" paramName="idRastreo"><bean:message key="migas.rastreos.realizados" /></html:link>
		 	/ <html:link forward="pStadistics" name="paramsPS"><bean:message key="migas.malware.personal.stadistic"/> </html:link>
		 	
		 	<logic:equal name="isHT" value="<%= Constants.TYPE_PS_PARAM_MODULE %>" >
		 		/ <html:link forward="pStadistics" name="paramsPSH"> <bean:message key="migas.malware.personal.stadistic.module"/></html:link>
		 	</logic:equal>
		 	<logic:equal name="isHT" value="<%= Constants.TYPE_PS_PARAM_HIT %>" >
		 		/ <html:link forward="pStadistics" name="paramsPSH"> <bean:message key="migas.malware.personal.stadistic.hit"/></html:link>
		 	</logic:equal>
		 	<logic:equal name="isHT" value="<%= Constants.TYPE_PS_PARAM_TERM %>" >
		 		/ <html:link forward="pStadistics" name="paramsPSH"> <bean:message key="migas.malware.personal.stadistic.termino"/></html:link>
		 	</logic:equal>
		 	
		 	/ <bean:message key="migas.malware.personal.stadistic.results"/>
		</p>
	</div>
	
	<div id="cuerpo">
		<div id="cIzq">&nbsp;</div>
		<div id="contenido">
			<div id="main">
				<h1 class="bulleth1"> <bean:message key="malware.personal.stadistics"/> </h1>
	
				<div id="cuerpoprincipal">
					
					<div id="container_menu_izq">
						<jsp:include page="menu.jsp"/>
					</div>
					
					<div id="container_der">
						<div class="cajaformularios">
							<h2 class="config"><bean:message key="malware.personal.stadistics" /></h2>
							
							<logic:empty name="<%=Constants.MALWARE_RESULTS_LIST %>">	
								<div class="notaInformativaExito">
									<p><bean:message key="malware.personal.stadistics.result.empty"/></p>
								</div>
							</logic:empty>
							
							<logic:notEmpty name="<%=Constants.MALWARE_RESULTS_LIST %>">
								<div class="detail">
									<p><bean:message key="malware.personal.stadistics.leyend" /></p>
									<p><bean:message key="malware.personal.stadistics.leyend.separator" /></p>
									<ul>
										<li><bean:message key="malware.personal.stadistics.leyend.A" /></li>
										<li><bean:message key="malware.personal.stadistics.leyend.B" /></li>
										<li><bean:message key="malware.personal.stadistics.leyend.C" /></li>
										<li><bean:message key="malware.personal.stadistics.leyend.D" /></li>
									</ul>
								</div>
								
								<bean:define id="modA"><inteco:properties file="malware.properties" key="modulo.a.hit.id"/></bean:define>
								<bean:define id="modB"><inteco:properties file="malware.properties" key="modulo.b.hit.id"/></bean:define>
								<bean:define id="modC"><inteco:properties file="malware.properties" key="modulo.c.hit.id"/></bean:define>
								<bean:define id="modD"><inteco:properties file="malware.properties" key="modulo.d.hit.id"/></bean:define>
								
								<bean:define id="existA" value="false" />
								<bean:define id="existB" value="false" />
								<bean:define id="existC" value="false" />
								<bean:define id="existD" value="false" />
								
								<logic:iterate id="list" name="<%= Constants.ELECTION_LIST %>">
									<logic:equal name="list" value="<%= modA %>">
										<bean:define id="existA" value="true" />
									</logic:equal>
									<logic:equal name="list" value="<%= modB %>">
										<bean:define id="existB" value="true" />
									</logic:equal>
									<logic:equal name="list" value="<%= modC %>">
										<bean:define id="existC" value="true" />
									</logic:equal>
									<logic:equal name="list" value="<%= modD %>">
										<bean:define id="existD" value="true" />
									</logic:equal>
								</logic:iterate>
								
								<logic:notEmpty name="<%= Constants.MALWARE_RESULTS_LIST %>">
									<div class="pag">
										<table>
											<tr>
												<th><bean:message key="malware.personal.stadistics.url"/></th>
												<logic:equal value="true" name="existA">
													<th><bean:message key="malware.personal.stadistics.moduloA"/></th>
												</logic:equal>
												<logic:equal value="true" name="existB">
													<th><bean:message key="malware.personal.stadistics.moduloB"/></th>
												</logic:equal>
												<logic:equal value="true" name="existC">
													<th><bean:message key="malware.personal.stadistics.moduloC"/></th>
												</logic:equal>
												<logic:equal value="true" name="existD">
													<th><bean:message key="malware.personal.stadistics.moduloD"/></th>
												</logic:equal>
												<th></th>
											</tr>
											<logic:iterate id="elemento" name="<%= Constants.MALWARE_RESULTS_LIST %>">
												<bean:define id="urlId" name="elemento" property="idUrl"/>
												<c:set target="${paramsD}" property="${urlIdName}" value="${urlId}"/>
												<tr>
													<td><bean:write name="elemento" property="url"/></td>
													<logic:equal value="true" name="existA">
														<td><bean:write name="elemento" property="moduloA"/></td>
													</logic:equal>
													<logic:equal value="true" name="existB">
														<td><bean:write name="elemento" property="moduloB"/></td>
													</logic:equal>
													<logic:equal value="true" name="existC">
														<td><bean:write name="elemento" property="moduloC"/></td>
													</logic:equal>
													<logic:equal value="true" name="existD">
														<td><bean:write name="elemento" property="moduloD"/></td>
													</logic:equal>
													<td><html:link forward="moduleDetailPS" name="paramsD"><bean:message key="malware.personal.stadistics.detalle" /></html:link></td>
												</tr>
											</logic:iterate>
										</table>
										<jsp:include page="pagination.jsp" />
									</div>
								</logic:notEmpty>
							</logic:notEmpty>
							<div id="pCenter">
								<html:link styleClass="boton" forward="loadPS" name="paramsVolver"><bean:message key="boton.volver" /></html:link>
							</div>
						</div>
					</div>
				</div><!-- fin CUERPO PRINCIPAL -->
			</div>
		</div>	
	</div> 
