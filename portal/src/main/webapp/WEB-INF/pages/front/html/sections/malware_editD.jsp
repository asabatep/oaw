<%@ include file="/common/taglibs.jsp" %> 
<%@page import="es.inteco.common.Constants"%>
<%@page import="java.util.HashMap"%>
<html:xhtml/>
<html:javascript formName="ConfigDForm"/>

	<div id="migas">
		<p class="oculto"><bean:message key="ubicacion.usuario" /> </p>
		<p>
			<html:link forward="indexAdmin"><bean:message key="migas.inicio" /></html:link>
		 	/ <html:link forward="configModuloDMenu"><bean:message key="migas.config.malware.d" /></html:link>
		 	/ <bean:message key="migas.edit.malware.d"/> 
	 	</p>
	</div>
	
	<div id="cuerpo">
		<div id="cIzq">&nbsp;</div>
		<div id="contenido">
			<div id="main">
				<h1 class="bulleth1"> <bean:message key="malware.config.d"/> </h1>
	
				<div id="cuerpoprincipal">
					
					<div id="container_menu_izq">
						<jsp:include page="menu.jsp"/>
					</div>
					
					<div id="container_der">
						<h2 class="config"><bean:message key="malware.config.d.head" /></h2>
					
						<p>
							<bean:message key="malware.config.d.info"/>
						</p>
						
						<html:form action="/secure/ConfigurarModuloD.do" styleClass="formulario" method="post" onsubmit="return validateConfigDForm(this)">
							<input type="hidden" name="action" value="<%= Constants.SUBMIT_EDIT %>"/>
							<html:hidden name="<%=Constants.CONFIG_FORM %>" property="certWhiteList"/>
							<html:hidden name="<%=Constants.CONFIG_FORM %>" property="certBlackList"/>
							<fieldset>
								<jsp:include page="/common/crawler_messages.jsp" />
								<fieldset>
									<div class="formItem">
										<label for="weight"><strong class="labelVisu"><acronym title="<bean:message key="campo.obligatorio" />"> * </acronym><bean:message key="malware.module.weight" />: </strong></label>
										<html:text styleId="weight" name="<%=Constants.CONFIG_FORM %>" property="weight" />
									</div>
									
									<div class="formItem">
										<label for="confidence"><strong class="labelVisu"><acronym title="<bean:message key="campo.obligatorio" />"> * </acronym><bean:message key="malware.module.confidence" />: </strong></label>
										<html:text styleId="confidence" name="<%=Constants.CONFIG_FORM %>" property="confidence" />
									</div>
								</fieldset>
								
								<fieldset>
									<div class="formItem">
										<bean:define id="javascriptTerms">
											<inteco:properties key="ofuscado.hit.id" file="malware.properties" />
										</bean:define>
										<strong class="labelVisu"><html:link forward="loadTerms" paramId="<%=Constants.ID_HIT %>" paramName="javascriptTerms"><bean:message key="malware.javascript" /></html:link></strong>
									</div>
									
									<div class="formItem">	
										<label for="javascriptWeight"><strong class="labelVisu"><acronym title="<bean:message key="campo.obligatorio" />"> * </acronym><bean:message key="malware.weight" />: </strong></label>
										<html:text styleId="javascriptWeight" name="<%=Constants.CONFIG_FORM %>" property="javascriptWeight" /> 
									</div>
									
									<div class="formItem">	
										<label for="javascriptConfidence"><strong class="labelVisu"><acronym title="<bean:message key="campo.obligatorio" />"> * </acronym><bean:message key="malware.confidence" />: </strong></label>
										<html:text styleId="javascriptConfidence" name="<%=Constants.CONFIG_FORM %>" property="javascriptConfidence" />
									</div>
								</fieldset>
								
								<fieldset>
									<div class="formItem">
										<bean:define id="actionscriptTerms">
											<inteco:properties key="actionscript.hit.id" file="malware.properties" />
										</bean:define>
										<strong class="labelVisu"><html:link forward="loadTerms" paramId="<%=Constants.ID_HIT %>" paramName="actionscriptTerms"><bean:message key="malware.actionscript" /></html:link></strong>
									</div>
									
									<div class="formItem">	
										<label for="actionscriptWeight"><strong class="labelVisu"><acronym title="<bean:message key="campo.obligatorio" />"> * </acronym><bean:message key="malware.weight" />: </strong></label>
										<html:text styleId="actionscriptWeight" name="<%=Constants.CONFIG_FORM %>" property="actionscriptWeight" /> 
									</div>
									
									<div class="formItem">
										<label for="actionscriptConfidence"><strong class="labelVisu"><acronym title="<bean:message key="campo.obligatorio" />"> * </acronym><bean:message key="malware.confidence" />: </strong></label>
										<html:text styleId="actionscriptConfidence" name="<%=Constants.CONFIG_FORM %>" property="actionscriptConfidence" />
									</div>
								</fieldset>
								
								<fieldset>
									<div class="formItem">
										<html:link forward="uploadWLFile"><img alt="<bean:message key="malware.uploadFile.alt" />" src="../images/uploadFile.bmp"/></html:link>
										<logic:notEmpty name="<%= Constants.CONFIG_FORM %>" property="certWhiteList">
											<logic:notEqual name="<%= Constants.CONFIG_FORM %>" property="certWhiteListEdit" value="true">
												<bean:define id="file" name="<%= Constants.CONFIG_FORM %>" property="certWhiteList"/>
												<html:link forward="editWLFile" paramId="<%= Constants.FILE %>" paramName="file"><img alt="<bean:message key="malware.editFile.alt" />" src="../images/editFile.bmp"/></html:link>
											</logic:notEqual>
										</logic:notEmpty>
										<logic:empty name="<%= Constants.CONFIG_FORM %>" property="certWhiteList">
											<img src="../images/editFile_GRISES.bmp" alt="<bean:message key="malware.editFile.alt" />"/>
										</logic:empty>
										<logic:equal name="<%= Constants.CONFIG_FORM %>" property="certWhiteListEdit" value="true">
											<img src="../images/editFile_GRISES.bmp" alt="<bean:message key="malware.editFile.alt" />"/>
										</logic:equal>
										<label for="certWhiteList"><strong class="labelVisu"><acronym title="<bean:message key="campo.obligatorio" />"> * </acronym><bean:message key="malware.white.list.certificates" />: </strong></label>
										<bean:write name="<%= Constants.CONFIG_FORM %>" property="certWhiteList" ignore="true"/>
									</div>
									
									<div class="formItem">	
										<label for="certWhiteListWeight"><strong class="labelVisu"><acronym title="<bean:message key="campo.obligatorio" />"> * </acronym><bean:message key="malware.weight" />: </strong></label>
										<html:text styleId="certWhiteListWeight" name="<%=Constants.CONFIG_FORM %>" property="certWhiteListWeight" /> 
									</div>
									
									<div class="formItem">	
										<label for="certWhiteListConfidence"><strong class="labelVisu"><acronym title="<bean:message key="campo.obligatorio" />"> * </acronym><bean:message key="malware.confidence" />: </strong></label>
										<html:text styleId="certWhiteListConfidence" name="<%=Constants.CONFIG_FORM %>" property="certWhiteListConfidence" />
									</div>
								</fieldset>
								
								<fieldset>
									<div class="formItem">
										<html:link forward="uploadBLFile"><img alt="<bean:message key="malware.uploadFile.alt" />" src="../images/uploadFile.bmp"/></html:link>
										<logic:notEmpty name="<%= Constants.CONFIG_FORM %>" property="certBlackList">
											<logic:notEqual name="<%= Constants.CONFIG_FORM %>" property="certBlackListEdit" value="true">
												<bean:define id="file" name="<%= Constants.CONFIG_FORM %>" property="certBlackList"/>
												<html:link forward="editBLFile" paramId="<%= Constants.FILE %>" paramName="file"><img alt="<bean:message key="malware.editFile.alt" />" src="../images/editFile.bmp"/></html:link>
											</logic:notEqual>
										</logic:notEmpty>
										<logic:empty  name="<%= Constants.CONFIG_FORM %>" property="certBlackList">
											<img src="../images/editFile_GRISES.bmp" alt="<bean:message key="malware.editFile.alt" />"/>
										</logic:empty>
										<logic:equal name="<%= Constants.CONFIG_FORM %>" property="certBlackListEdit" value="true">
											<img src="../images/editFile_GRISES.bmp" alt="<bean:message key="malware.editFile.alt" />"/>
										</logic:equal>
										<label for="certBlackList"><strong class="labelVisu"><acronym title="<bean:message key="campo.obligatorio" />"> * </acronym><bean:message key="malware.black.list.certificates" />: </strong> </label>
										<bean:write name="<%= Constants.CONFIG_FORM %>" property="certBlackList"/>
									</div>
									
									<div class="formItem">	
										<label for="certBlackListWeight"><strong class="labelVisu"><acronym title="<bean:message key="campo.obligatorio" />"> * </acronym><bean:message key="malware.weight" />: </strong></label>
										<html:text styleId="certBlackListWeight" name="<%=Constants.CONFIG_FORM %>" property="certBlackListWeight" />
									</div>
									
									<div class="formItem">	
										<label for="certBlackListConfidence"><strong class="labelVisu"><acronym title="<bean:message key="campo.obligatorio" />"> * </acronym><bean:message key="malware.confidence" />: </strong></label>
										<html:text styleId="certBlackListConfidence" name="<%=Constants.CONFIG_FORM %>" property="certBlackListConfidence" />
									</div>
								</fieldset>
								
								<div class="formButton">
									<html:submit><bean:message key="boton.aceptar" /></html:submit>
									<html:cancel><bean:message key="boton.cancelar" /></html:cancel>
								</div>
							</fieldset>
						</html:form>
					</div>
				</div><!-- fin CUERPO PRINCIPAL -->
			</div>
		</div>	
	</div> 
