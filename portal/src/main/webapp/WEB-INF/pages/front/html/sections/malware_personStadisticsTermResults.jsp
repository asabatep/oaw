<%@ include file="/common/taglibs.jsp" %> 
<%@page import="es.inteco.common.Constants"%>
<%@page import="java.util.HashMap"%>
<html:xhtml/>
<html:javascript formName="ConfigBForm"/>
	
	<bean:parameter id="idRastreo" name="<%= Constants.ID_RASTREO %>"/>
	<bean:parameter id="isHT" name="<%= Constants.TYPE_PS_PARAM %>" />
	<bean:parameter id="id" name="<%= Constants.ID %>" />
	
	<bean:define id="idRastreoName" value="<%= Constants.ID_RASTREO %>"/>
	<bean:define id="typePSName" value="<%= Constants.TYPE_PS_PARAM %>"/>
	<bean:define id="idName" value="<%= Constants.ID %>"/>
	<bean:define id="typePSName" value="<%= Constants.TYPE_PS_PARAM %>"/>
	<bean:define id="actionParam" value="<%= Constants.ACTION %>" />
	<bean:define id="loadPSParam" value="<%= Constants.LOAD_PS %>" />
	<bean:define id="urlIdName" value="<%= Constants.URL_ID %>" />
	
	<jsp:useBean id="paramsPS" class="java.util.HashMap" />
	<c:set target="${paramsPS}" property="${idRastreoName}" value="${idRastreo}" />
	<c:set target="${paramsPS}" property="${idName}" value="${id}" />
	
	<jsp:useBean id="paramsPSH" class="java.util.HashMap" />
	<c:set target="${paramsPSH}" property="${idRastreoName}" value="${idRastreo}" />
	<c:set target="${paramsPSH}" property="${idName}" value="${id}" />
	<c:set target="${paramsPSH}" property="${typePSName}" value="${isHT}" />
	<c:set target="${paramsPSH}" property="${actionParam}" value="${loadPSParam}" />
	
	<jsp:useBean id="paramsD" class="java.util.HashMap" />
	<c:set target="${paramsD}" property="${idName}" value="${id}"/>
	<c:set target="${paramsD}" property="${idRastreoName}" value="${idRastreo}"/>
	<c:set target="${paramsD}" property="${typePSName}" value="${isHT}"/>
	
	<jsp:useBean id="paramsVolver" class="java.util.HashMap"/>
	<c:set target="${paramsVolver}" property="${idName}" value="${id}"/>
	<c:set target="${paramsVolver}" property="${typePSName}" value="${isHT}"/>
	<c:set target="${paramsVolver}" property="${idRastreoName}" value="${idRastreo}"/>
	
	<div id="migas">
		<p class="oculto"><bean:message key="ubicacion.usuario" /> </p>
		<p><html:link forward="indexAdmin"><bean:message key="migas.inicio" /></html:link> / 
			<html:link forward="crawlingsMenu"><bean:message key="migas.rastreo" /></html:link> /
		 	<html:link forward="verRastreosRealizados" paramId="<%= Constants.ID_RASTREO %>" paramName="idRastreo"><bean:message key="migas.rastreos.realizados" /></html:link>
		 	/ <html:link forward="pStadistics" name="paramsPS"><bean:message key="migas.malware.personal.stadistic"/> </html:link>
		 	
		 	<logic:equal name="isHT" value="<%= Constants.TYPE_PS_PARAM_MODULE %>" >
		 		/ <html:link forward="pStadistics" name="paramsPSH"> <bean:message key="migas.malware.personal.stadistic.module"/></html:link>
		 	</logic:equal>
		 	<logic:equal name="isHT" value="<%= Constants.TYPE_PS_PARAM_HIT %>" >
		 		/ <html:link forward="pStadistics" name="paramsPSH"> <bean:message key="migas.malware.personal.stadistic.hit"/></html:link>
		 	</logic:equal>
		 	<logic:equal name="isHT" value="<%= Constants.TYPE_PS_PARAM_TERM %>" >
		 		/ <html:link forward="pStadistics" name="paramsPSH"> <bean:message key="migas.malware.personal.stadistic.termino"/></html:link>
		 	</logic:equal>
		 	
		 	/ <bean:message key="migas.malware.personal.stadistic.results"/>
		</p>
	</div>
	
	<div id="cuerpo">
		<div id="cIzq">&nbsp;</div>
		<div id="contenido">
			<div id="main">
				<h1 class="bulleth1"> <bean:message key="malware.personal.stadistics"/> </h1>
	
				<div id="cuerpoprincipal">
					
					<div id="container_menu_izq">
						<jsp:include page="menu.jsp"/>
					</div>
					
					<div id="container_der">
						<div class="cajaformularios">
							<h2 class="config"><bean:message key="malware.personal.stadistics" /></h2>
							
							<logic:empty name="<%=Constants.MALWARE_RESULTS_LIST %>">	
								<div class="notaInformativaExito">
									<p><bean:message key="malware.personal.stadistics.result.empty"/></p>
								</div>
							</logic:empty>
							
							<logic:notEmpty name="<%=Constants.MALWARE_RESULTS_LIST %>">
								<div class="detail">
									<p><bean:message key="malware.personal.stadistics.hits.info.1" /></p>
									<p><bean:message key="malware.personal.stadistics.hits.info.2" /></p>
								</div>
								
								<div class="pag">
									<table>
										<tr>
											<th><bean:message key="malware.personal.stadistics.url" /></th>
											<logic:iterate id="elemento" name="<%= Constants.MALWARE_RESULTS_LIST %>" offset="0" length="1">
												<c:set target="${paramsD}" property="${urlIdName}" value="${urlId}"/>
												<bean:define id="urlId" name="elemento" property="idUrl"/>
												<logic:iterate id="terminos" name="elemento" property="termList">
													<th><bean:write name="terminos" property="term"/></th>
												</logic:iterate>
											</logic:iterate>
											<th><bean:message key="malware.personal.stadistics.detalleM" /></th>
										</tr>
										<logic:iterate id="elemento" name="<%= Constants.MALWARE_RESULTS_LIST %>">
											<tr>
												<td>
													<a href="<bean:write name="elemento" property="url" />" ><bean:write name="elemento" property="url" /></a>
												</td>
												<logic:iterate id="terminos" name="elemento" property="termList">
													<td><bean:write name="terminos" property="occurrences"/></td>
												</logic:iterate>
												<td><html:link forward="termDetailPS" name="paramsD"><bean:message key="malware.personal.stadistics.detalle" /></html:link></td>
											</tr>
										</logic:iterate> 
									</table>
									<jsp:include page="pagination.jsp" />
								</div>
							</logic:notEmpty>
							<div id="pCenter">
								<html:link styleClass="boton" forward="loadPS" name="paramsVolver"><bean:message key="boton.volver" /></html:link>
							</div>
						</div>
					</div>
				</div><!-- fin CUERPO PRINCIPAL -->
			</div>
		</div>	
	</div> 
