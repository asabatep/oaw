<%@ include file="/common/taglibs.jsp" %> 
<%@page import="es.inteco.common.Constants"%>
<%@page import="java.util.HashMap"%>
<html:xhtml/>
<html:javascript formName="ConfigBForm"/>
	
	<bean:parameter id="idRastreo" name="<%= Constants.ID_RASTREO %>"/>
	<bean:parameter id="id" name="<%= Constants.ID %>"/>
	<bean:parameter id="isHT" name="<%= Constants.TYPE_PS_PARAM %>" />
	
	<bean:define id="idRastreoParam" value="<%= Constants.ID_RASTREO %>" />
	<bean:define id="idParam" value="<%= Constants.ID %>" />
	<bean:define id="actionParam" value="<%= Constants.ACTION %>" />
	<bean:define id="loadPSParam" value="<%= Constants.LOAD_PS %>" />
	<bean:define id="hitResultsPSParam" value="<%= Constants.HIT_RESULTS_PS %>" />
	<bean:define id="typePSParam" value="<%= Constants.TYPE_PS_PARAM %>"/>
	
	<jsp:useBean id="paramsPS" class="java.util.HashMap" />
	<c:set target="${paramsPS}" property="${idRastreoParam}" value="${idRastreo}" />
	<c:set target="${paramsPS}" property="${idParam}" value="${id}" />
	
	<jsp:useBean id="paramsPSH" class="java.util.HashMap" />
	<c:set target="${paramsPSH}" property="${idRastreoParam}" value="${idRastreo}" />
	<c:set target="${paramsPSH}" property="${idParam}" value="${id}" />
	<c:set target="${paramsPSH}" property="${typePSParam}" value="${isHT}" />
	
	<jsp:useBean id="paramsVolver" class="java.util.HashMap"/>
	<c:set target="${paramsVolver}" property="${idParam}" value="${id}"/>
	<c:set target="${paramsVolver}" property="${idRastreoParam}" value="${idRastreo}"/>
	<c:set target="${paramsVolver}" property="${typePSParam}" value="${isHT}"/>
	
	<div id="migas">
		<p class="oculto"><bean:message key="ubicacion.usuario" /> </p>
		<p><html:link forward="indexAdmin"><bean:message key="migas.inicio" /></html:link> / 
			<html:link forward="crawlingsMenu"><bean:message key="migas.rastreo" /></html:link> /
		 	<html:link forward="verRastreosRealizados" paramId="<%= Constants.ID_RASTREO %>" paramName="idRastreo"><bean:message key="migas.rastreos.realizados" /></html:link>
		 	/ <html:link forward="pStadistics" name="paramsPS"><bean:message key="migas.malware.personal.stadistic"/></html:link>
		 	
		 	<c:set target="${paramsPSH}" property="${actionParam}" value="${loadPSParam}" />
		 	<logic:equal name="isHT" value="<%= Constants.TYPE_PS_PARAM_MODULE %>" >
		 		/ <html:link forward="pStadistics" name="paramsPSH"> <bean:message key="migas.malware.personal.stadistic.module"/></html:link>
		 	</logic:equal>
		 	<logic:equal name="isHT" value="<%= Constants.TYPE_PS_PARAM_HIT %>" >
		 		/ <html:link forward="pStadistics" name="paramsPSH"> <bean:message key="migas.malware.personal.stadistic.hit"/></html:link>
		 	</logic:equal>
		 	<logic:equal name="isHT" value="<%= Constants.TYPE_PS_PARAM_TERM %>" >
		 		/ <html:link forward="pStadistics" name="paramsPSH"> <bean:message key="migas.malware.personal.stadistic.termino"/></html:link>
		 	</logic:equal>

		 	<c:set target="${paramsPSH}" property="${actionParam}" value="${hitResultsPSParam}" />
		 	/ <html:link forward="pStadistics" name="paramsPSH"><bean:message key="migas.malware.personal.stadistic.results"/></html:link>
		 	/ <bean:message key="migas.malware.personal.stadistic.detail"/>
		</p>
	</div>
	
	<div id="cuerpo">
		<div id="cIzq">&nbsp;</div>
		<div id="contenido">
			<div id="main">
				<h1 class="bulleth1"> <bean:message key="malware.personal.stadistics"/> </h1>
	
				<div id="cuerpoprincipal">
					
					<div id="container_menu_izq">
						<jsp:include page="menu.jsp"/>
					</div>
					
					<div id="container_der">
						<div class="cajaformularios">
							<h2 class="config"><bean:message key="malware.personal.stadistics" /></h2>
							
							<logic:empty name="<%=Constants.MALWARE_HIT_FORM %>">	
								<div class="notaInformativaExito">
									<p><bean:message key="malware.personal.stadistics.detail.empty"/></p>
								</div>
							</logic:empty>
								
							<logic:notEmpty name="<%= Constants.MALWARE_HIT_FORM %>">
								<bean:define id="modA"><inteco:properties file="malware.properties" key="modulo.a.hit.id"/></bean:define>
								<bean:define id="modB"><inteco:properties file="malware.properties" key="modulo.b.hit.id"/></bean:define>
								<bean:define id="modC"><inteco:properties file="malware.properties" key="modulo.c.hit.id"/></bean:define>
								<bean:define id="modD"><inteco:properties file="malware.properties" key="modulo.d.hit.id"/></bean:define>
								<bean:define id="reintentos"><inteco:properties file="malware.properties" key="reintentos.hit.id"/></bean:define>
								<bean:define id="redirecciones"><inteco:properties file="malware.properties" key="redirecciones.hit.id"/></bean:define>
								<bean:define id="terminosA"><inteco:properties file="malware.properties" key="terminos.a.hit.id"/></bean:define>
								<bean:define id="ofuscado"><inteco:properties file="malware.properties" key="ofuscado.hit.id"/></bean:define>
								<bean:define id="multimedia"><inteco:properties file="malware.properties" key="multimedia.hit.id"/></bean:define>
								<bean:define id="terminosB"><inteco:properties file="malware.properties" key="terminos.b.hit.id"/></bean:define>
								<bean:define id="DOM"><inteco:properties file="malware.properties" key="dom.hit.id"/></bean:define>
								<bean:define id="dominioWL"><inteco:properties file="malware.properties" key="dominio.wl.hit.id"/></bean:define>
								<bean:define id="dominioBL"><inteco:properties file="malware.properties" key="dominio.bl.hit.id"/></bean:define>
								<bean:define id="js"><inteco:properties file="malware.properties" key="javascript.hit.id"/></bean:define>
								<bean:define id="certificadosWL"><inteco:properties file="malware.properties" key="certificados.wl.hit.id"/></bean:define>
								<bean:define id="certificadosBL"><inteco:properties file="malware.properties" key="certificados.bl.hit.id"/></bean:define>
								<bean:define id="actionScript"><inteco:properties file="malware.properties" key="actionscript.hit.id"/></bean:define>
								
								<bean:define id="existA" value="false" />
								<bean:define id="existB" value="false" />
								<bean:define id="existC" value="false" />
								<bean:define id="existD" value="false" />
								<bean:define id="existReintentos" value="false" />
								<bean:define id="existRedirecciones" value="false" />
								<bean:define id="existATerm" value="false" />
								<bean:define id="existOfuscado" value="false" />
								<bean:define id="existMultimedia" value="false" />
								<bean:define id="existBTerm" value="false" />
								<bean:define id="existDOM" value="false" />
								<bean:define id="existDominioWL" value="false" />
								<bean:define id="existDominioBL" value="false" />
								<bean:define id="existJS" value="false" />
								<bean:define id="existCertWL" value="false" />
								<bean:define id="existCertBL" value="false" />
								<bean:define id="existActionScript" value="false" />
								
								<logic:iterate id="list" name="<%= Constants.ELECTION_LIST %>">
									<logic:equal name="list" value="<%= modA %>">
										<bean:define id="existA" value="true" />
									</logic:equal>
									<logic:equal name="list" value="<%= modB %>">
										<bean:define id="existB" value="true" />
									</logic:equal>
									<logic:equal name="list" value="<%= modC %>">
										<bean:define id="existC" value="true" />
									</logic:equal>
									<logic:equal name="list" value="<%= modD %>">
										<bean:define id="existD" value="true" />
									</logic:equal>
									<logic:equal name="list" value="<%= reintentos %>">
										<bean:define id="existReintentos" value="true" />
									</logic:equal>
									<logic:equal name="list" value="<%= redirecciones %>">
										<bean:define id="existRedirecciones" value="true" />
									</logic:equal>
									<logic:equal name="list" value="<%= terminosA %>">
										<bean:define id="existATerm" value="true" />
									</logic:equal>
									<logic:equal name="list" value="<%= ofuscado %>">
										<bean:define id="existOfuscado" value="true" />
									</logic:equal>
									<logic:equal name="list" value="<%= multimedia %>">
										<bean:define id="existMultimedia" value="true" />
									</logic:equal>
									<logic:equal name="list" value="<%= terminosB %>">
										<bean:define id="existBTerm" value="true" />
									</logic:equal>
									<logic:equal name="list" value="<%= DOM %>">
										<bean:define id="existDOM" value="true" />
									</logic:equal>
									<logic:equal name="list" value="<%= dominioWL %>">
										<bean:define id="existDominioWL" value="true" />
									</logic:equal>
									<logic:equal name="list" value="<%= dominioBL %>">
										<bean:define id="existDominioBL" value="true" />
									</logic:equal>
									<logic:equal name="list" value="<%= js %>">
										<bean:define id="existJS" value="true" />
									</logic:equal>
									<logic:equal name="list" value="<%= certificadosWL %>">
										<bean:define id="existCertWL" value="true" />
									</logic:equal>
									<logic:equal name="list" value="<%= certificadosBL %>">
										<bean:define id="existCertBL" value="true" />
									</logic:equal>
									<logic:equal name="list" value="<%= actionScript %>">
										<bean:define id="existActionScript" value="true" />
									</logic:equal>
								</logic:iterate>
								
								<div class="pag">
									<div class="detail">
										<a href="<bean:write name="<%= Constants.URL %>" />"><bean:write name="<%= Constants.URL %>" /></a>
									</div>
									<table>
										<tr>
											<th><bean:message key="malware.personal.stadistics.hitM" /></th>
											<th><bean:message key="malware.personal.stadistics.puntuacion" /></th>
										</tr>
										<logic:equal value="true" name="existA">
											<tr>
												<th><bean:message key="malware.personal.stadistics.moduloA"/></th>
												<td><bean:write name="<%= Constants.MALWARE_HIT_FORM %>" property="moduloA"/></td>
											</tr>
										</logic:equal>
										<logic:equal value="true" name="existB">
											<tr>
												<th><bean:message key="malware.personal.stadistics.moduloB"/></th>
												<td><bean:write name="<%= Constants.MALWARE_HIT_FORM %>" property="moduloB"/></td>
											</tr>
										</logic:equal>
										<logic:equal value="true" name="existC">
											<tr>
												<th><bean:message key="malware.personal.stadistics.moduloC"/></th>
												<td><bean:write name="<%= Constants.MALWARE_HIT_FORM %>" property="moduloC"/></td>
											</tr>
										</logic:equal>
										<logic:equal value="true" name="existD">
											<tr>
												<th><bean:message key="malware.personal.stadistics.moduloD"/></th>
												<td><bean:write name="<%= Constants.MALWARE_HIT_FORM %>" property="moduloD"/></td>
											</tr>
										</logic:equal>
										<logic:equal value="true" name="existReintentos">
											<tr>
												<th><bean:message key="malware.personal.stadistics.reintentos"/></th>
												<td><bean:write name="<%= Constants.MALWARE_HIT_FORM %>" property="reintentos"/></td>
											</tr>
										</logic:equal>
										<logic:equal value="true" name="existRedirecciones">
											<tr>
												<th><bean:message key="malware.personal.stadistics.redirecciones"/></th>
												<td><bean:write name="<%= Constants.MALWARE_HIT_FORM %>" property="redirecciones"/></td>
											</tr>
										</logic:equal>
										<logic:equal value="true" name="existATerm">
											<tr>
												<th><bean:message key="malware.personal.stadistics.terminosA"/></th>
												<td><bean:write name="<%= Constants.MALWARE_HIT_FORM %>" property="terminosA"/></td>
											</tr>
										</logic:equal>
										<logic:equal value="true" name="existOfuscado">
											<tr>
												<th><bean:message key="malware.personal.stadistics.ofuscado"/></th>
												<td><bean:write name="<%= Constants.MALWARE_HIT_FORM %>" property="ofuscado"/></td>
											</tr>
										</logic:equal>
										<logic:equal value="true" name="existMultimedia">
											<tr>
												<th><bean:message key="malware.personal.stadistics.multimedia"/></th>
												<td><bean:write name="<%= Constants.MALWARE_HIT_FORM %>" property="multimedia"/></td>
											</tr>
										</logic:equal>
										<logic:equal value="true" name="existBTerm">
											<tr>
												<th><bean:message key="malware.personal.stadistics.terminosB"/></th>
												<td><bean:write name="<%= Constants.MALWARE_HIT_FORM %>" property="terminosB"/></td>
											</tr>
										</logic:equal>
										<logic:equal value="true" name="existDOM">
											<tr>
												<th><bean:message key="malware.personal.stadistics.DOM"/></th>
												<td><bean:write name="<%= Constants.MALWARE_HIT_FORM %>" property="DOM"/></td>
											</tr>
										</logic:equal>
										<logic:equal value="true" name="existDominioWL">
											<tr>
												<th><bean:message key="malware.personal.stadistics.dominioWL"/></th>
												<td><bean:write name="<%= Constants.MALWARE_HIT_FORM %>" property="dominio"/></td>
											</tr>
										</logic:equal>
										<logic:equal value="true" name="existDominioBL">
											<tr>
												<th><bean:message key="malware.personal.stadistics.dominioBL"/></th>
												<td><bean:write name="<%= Constants.MALWARE_HIT_FORM %>" property="dominio"/></td>
											</tr>
										</logic:equal>
										<logic:equal value="true" name="existCertWL">
											<tr>
												<th><bean:message key="malware.personal.stadistics.certificadosWL"/></th>
												<td><bean:write name="<%= Constants.MALWARE_HIT_FORM %>" property="certificados"/></td>
											</tr>
										</logic:equal>
										<logic:equal value="true" name="existCertBL">
											<tr>
												<th><bean:message key="malware.personal.stadistics.certificadosBL"/></th>
												<td><bean:write name="<%= Constants.MALWARE_HIT_FORM %>" property="certificados"/></td>
											</tr>
										</logic:equal>
										<logic:equal value="true" name="existJS">
											<tr>
												<th><bean:message key="malware.personal.stadistics.js"/></th>
												<td><bean:write name="<%= Constants.MALWARE_HIT_FORM %>" property="js"/></td>
											</tr>
										</logic:equal>
										<logic:equal value="true" name="existActionScript">
											<tr>
												<th><bean:message key="malware.personal.stadistics.ac"/></th>
												<td><bean:write name="<%= Constants.MALWARE_HIT_FORM %>" property="actionscript"/></td>
											</tr>
										</logic:equal> 
									</table>
								</div>
							</logic:notEmpty>
								
							<div id="pCenter">
								<html:link styleClass="boton" forward="hitResultsPS" name="paramsVolver"><bean:message key="boton.volver" /></html:link>
							</div>
						</div>
					</div>
				</div><!-- fin CUERPO PRINCIPAL -->
			</div>
		</div>	
	</div> 
